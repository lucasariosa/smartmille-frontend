<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>SmartMille</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  background:#f4f6f8;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  margin:0;
  padding:40px 16px;
  color:#111827;
}

.container {
  max-width: 520px;
  margin:auto;
}

h1 {
  text-align:center;
  margin-bottom:24px;
}

input, select, button {
  width:100%;
  padding:14px;
  margin-bottom:12px;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-size:15px;
  box-sizing:border-box;
}

button {
  background:#111827;
  color:white;
  font-weight:600;
  cursor:pointer;
}

button:disabled {
  opacity:0.6;
  cursor:not-allowed;
}

.status {
  text-align:center;
  margin:12px 0;
  font-size:14px;
  color:#374151;
}

.error {
  color:#b91c1c;
  text-align:center;
  margin-top:10px;
}

.carousel {
  margin-top:32px;
  display:grid;
  gap:32px;
}

/* ===== SLIDE ===== */

.slide {
  position:relative;
  width:100%;
  aspect-ratio:4/5;
  overflow:hidden;
  border-radius:18px;
  background:#000;
}

.slide img {
  width:100%;
  height:100%;
  object-fit:cover;
}

/* Overlay mais sofisticado */
.overlay {
  position:absolute;
  inset:0;
  background:linear-gradient(
    to bottom,
    rgba(0,0,0,.25),
    rgba(0,0,0,.85)
  );
  padding:28px;
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
}

/* ===== LETTERING ===== */

.headline {
  font-size:26px;
  font-weight:800;
  line-height:1.15;
  margin-bottom:14px;
  color:#ffffff;
  max-width:90%;
}

.text {
  font-size:15px;
  line-height:1.5;
  color:#e5e7eb;
  max-width:95%;
}

/* Slide 2 com CTA mais forte */
.slide.cta .headline {
  font-size:24px;
}

.slide.cta .text {
  margin-top:6px;
  font-weight:500;
}
</style>
</head>

<body>

<div class="container">
  <h1>SmartMille</h1>

  <input id="nome" placeholder="Nome do advogado(a)">
  <input id="contato" placeholder="WhatsApp">
  <input id="area" placeholder="Área de atuação">
  <input id="publico" placeholder="Público-alvo">

  <select id="tipo">
    <option value="introducao">Introdução sobre o assunto</option>
    <option value="definicao">Definição sobre o assunto</option>
    <option value="conclusao">Conclusão sobre o assunto</option>
  </select>

  <input id="tema" placeholder="Tema do carrossel">

  <button id="btn" onclick="gerar()">Gerar carrossel</button>

  <div id="status" class="status"></div>
  <div id="erro" class="error"></div>

  <div id="resultado" class="carousel"></div>
</div>

<script>
async function gerar() {
  const btn = document.getElementById("btn");
  const status = document.getElementById("status");
  const erro = document.getElementById("erro");
  const resultado = document.getElementById("resultado");

  erro.innerText = "";
  resultado.innerHTML = "";

  const payload = {
    nome: nome.value,
    contato: contato.value,
    area: area.value,
    publico: publico.value,
    tipo: tipo.value,
    tema: tema.value
  };

  btn.disabled = true;
  btn.innerText = "Gerando...";
  status.innerText = "Gerando carrossel, isso pode levar até 1 minuto…";

  try {
    const res = await fetch(
      "https://smartmille-backend.onrender.com/gerar-carrossel",
      {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify(payload)
      }
    );

    const data = await res.json();

    if (data.erro) {
      erro.innerText = data.erro;
      return;
    }

    status.innerText = "Carrossel gerado com sucesso.";

    data.slides.forEach((s, idx) => {
      const div = document.createElement("div");
      div.className = "slide" + (idx === 1 ? " cta" : "");
      div.innerHTML = `
        <img src="data:image/png;base64,${s.imagem}">
        <div class="overlay">
          <div class="headline">${s.headline}</div>
          <div class="text">${s.texto}</div>
        </div>
      `;
      resultado.appendChild(div);
    });

  } catch (e) {
    erro.innerText = "Erro ao gerar carrossel.";
  } finally {
    btn.disabled = false;
    btn.innerText = "Gerar carrossel";
    status.innerText = "";
  }
}
</script>

</body>
</html>
